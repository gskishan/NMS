{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2024-12-28 00:56:21.154956",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Sales Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "<div style=\"font-family: Arial, sans-serif; font-size: 12px;\">\n    <table style=\"width: 100%; margin-bottom: 20px; border-collapse: collapse;\">\n        <tr>\n            <td style=\"font-weight: bold;\">Submission Date:</td>\n            <td>{{ doc.posting_date }}</td>\n            <td style=\"font-weight: bold;\">Payment Certificate No:</td>\n            <td>{{ doc.payment_certificate_no or '' }}</td>\n        </tr>\n    </table>\n\n    <h3 style=\"margin-top: 20px; margin-bottom: 10px;\">JOB INFORMATION</h3>\n\n    <table style=\"width: 100%; border-collapse: collapse; border: 1px solid #000;\">\n        <tr>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Info.</td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"3\">Description</td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Info.</td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"3\">Description</td>\n        </tr>\n        <tr>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Project Name</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Contractor</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n        </tr>\n        <tr>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Tender No. (if applicable)</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">PO/Contract Date</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n        </tr>\n        <tr>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">PO/Contract Number</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Commencement Date</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n        </tr>\n        <tr>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Client</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Expected Completion Date</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n        </tr>\n        <tr>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Extension Duration (if applicable)</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Revised Completion Date</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n        </tr>\n        <tr>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Department</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">SIP Project Manager</td>\n            <td style=\"border: 1px solid #000; padding: 5px;\" colspan=\"3\"></td>\n        </tr>\n    </table>\n    <br>\n    <table class=\"table table-bordered\">\n        <tbody>\n            <tr>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Company Name</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"3\">{{ doc.company or \" \" }}</td>\n            </tr>\n            <tr>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Representative Name</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"3\">{{ doc.customer or \" \" }}</td>\n            </tr>\n            <tr>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Position</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">{{ \" \" }}</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Account No.</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">{{ doc.custom_account_no or \" \" }}</td>\n            </tr>\n            <tr>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Mobile</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">{{ \" \" }}</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Bank Name</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">{{ doc.custom_bank_name or \" \" }}</td>\n            </tr>\n            <tr>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Phone</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">{{ \" \" }}</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Branch Name</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">{{ doc.custom_bank_branch or \" \" }}</td>\n            </tr>\n            <tr>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Email</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">{{ \" \" }}</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">Swift Code</td>\n                <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" colspan=\"1\">{{ doc.custom_swift_code or \" \" }}</td>\n            </tr>\n        <tbody>\n    </table>\n<br>    \n<b>Remarks</b><br>\n\n<b>Contractor Signature</b><br>\n<b>For SOHAR Port and Free Zone Use Only</b><br>\n<table class=\"table table-bordered\">\n    <tbody>\n        <tr>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" >Engineer</td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" >Line Manager</td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" >Head of Department</td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\" >Finance Department</td>\n        </tr>\n        <tr>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\"></td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\"></td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\"></td>\n            <td style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\"></td>\n        </tr>\n    <tbody>\n</table>\n<table class=\"table table-bordered\">\n    <thead>\n        <tr>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">No</th>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Description</th>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Sales Order Qty</th>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Unit</th>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Total Sales Order Amount</th>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Event Completed Qty</th>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Current Event Qty</th>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Cumulative Amount</th>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Invoice Current Amount</th>\n            <th style=\"font-weight: bold; border: 1px solid #000; padding: 5px;\">Balance Amount</th>\n        </tr>\n    </thead>\n    <tbody>\n        {% set index = 1 %}\n        {% for item in doc.items %}\n        {% set so_data = frappe.db.get_value(\n            \"Sales Order Item\",\n            {\"parent\": doc.custom_sales_order, \"item_code\": item.item_code},\n            [\"qty\", \"amount\"],\n            as_dict=True\n        ) %}\n        {% if so_data %}\n            {% set invoices = frappe.db.sql(\"\"\"\n                SELECT sii.qty, sii.amount\n                FROM `tabSales Invoice Item` sii\n                JOIN `tabSales Invoice` si ON sii.parent = si.name\n                WHERE si.custom_sales_order = %s AND sii.item_code = %s AND si.docstatus = 1\n                ORDER BY si.posting_date, si.name\n            \"\"\", (doc.custom_sales_order, item.item_code), as_dict=True) %}\n\n            {% set cumulative_qty = 0 %}\n            {% set cumulative_amount = 0 %}\n\n            {% for invoice in invoices %}\n                {% set _ = cumulative_qty + invoice.qty %}\n                {% set cumulative_qty = _ %}\n                {% set _ = cumulative_amount + invoice.amount %}\n                {% set cumulative_amount = _ %}\n                {% set balance_qty = so_data.qty - cumulative_qty %}\n                {% set balance_amount = so_data.amount - cumulative_amount %}\n                <tr>\n                    <td>{{ index }}</td>\n                    <td>{{ item.description }}</td>\n                    <td>{{ so_data.qty }}</td>\n                    <td>{{ item.uom }}</td>\n                    <td>{{ so_data.amount }}</td>\n                    <td>{{ cumulative_qty }}</td>\n                    <td>{{ invoice.qty }}</td>\n                    <td>{{ cumulative_amount }}</td>\n                    <td>{{ invoice.amount }}</td>\n                    <td>{{ balance_amount }}</td>\n                </tr>\n                {% set index = index + 1 %}\n            {% endfor %}\n        {% else %}\n            <tr>\n                <td colspan=\"10\">No Sales Order Data Found</td>\n            </tr>\n        {% endif %}\n        {% endfor %}\n    </tbody>\n</table>\n\n\n</div>\n<br>\n<h2>PAYMENT CERTIFICATE SUMMARY</h2>",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2024-12-30 10:05:15.110205",
 "modified_by": "Administrator",
 "module": "Nms",
 "name": "Special Contract Invoice",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}